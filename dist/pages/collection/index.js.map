{"version":3,"file":"pages/collection/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAaA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AC0CA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AAEA;AACA;;;;;;;;;;;;;;;;;AA/JA;AAAA;;;;AAgBA;AAAA;;;AAGA;AAAA;;AACA;AAAA;;AACA;AAAA;;AAGA;AAAA;;AACA;AAAA;;AAEA;AAAA;;AAEA;AAAA;;AAEA;AAAA;;AAUA;AAAA;;AAaA;AAAA;;AAGA;AAAA;;;;;AAzDA;AAEA;AACA;AACA;;;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAEA;AAOA;AAAA;AAEA;AAAA;AAKA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAIA;;AAGA;AACA;AACA;;AACA;AAAA;;;AAGA;AAIA;AACA;AAAA;;;AADA;AAIA;AAAA;;;AADA;;;;;;;;;;;;;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACPA","sources":["webpack://aydwj/./src/pages/collection/index.vue?30f5","webpack://aydwj/._src_pages_collection_index.vue","webpack://aydwj/./src/pages/collection/index.vue?9cc9","webpack://aydwj/./src/pages/collection/index.vue?e9c8","webpack://aydwj/./src/pages/collection/index.vue?ed05"],"sourcesContent":["import { render } from \"./index.vue?vue&type=template&id=130d4e25&ts=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=130d4e25&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\aligu\\\\Downloads\\\\miniapp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/collection/index.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"130d4e25\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('130d4e25', __exports__)) {\n    api.reload('130d4e25', __exports__)\n  }\n  \n  module.hot.accept(\"./index.vue?vue&type=template&id=130d4e25&ts=true\", () => {\n    api.rerender('130d4e25', render)\n  })\n\n}\n\n\nexport default __exports__","<template>\r\n  <view class=\"collection\">\r\n    <scroll-view\r\n      class=\"list\"\r\n      :scroll-y=\"true\"\r\n      @scrolltolower=\"lower\"\r\n      :scroll-into-view=\"toView\"\r\n      :scroll-top=\"scrollTop\"\r\n    >\r\n      <view\r\n        v-for=\"(it, idx) in dataList\"\r\n        :key=\"idx\"\r\n        class=\"it\"\r\n        @touchstart=\"touchstart($event)\"\r\n        @touchend=\"touchend($event, it)\"\r\n        @click=\"toAyDetail(it)\"\r\n      >\r\n        <view class=\"left\">\r\n          <img class=\"img\" :src=\"it.avatar\" />\r\n        </view>\r\n        <view class=\"right\">\r\n          <view class=\"top\">\r\n            <view class=\"name\"\r\n              >{{ it.lastname }}{{ it.firstname || \"阿姨\" }}</view\r\n            >\r\n            <view class=\"info\">\r\n              <view class=\"info-it\">{{ it.servLocation }}</view>\r\n              <nut-divider direction=\"vertical\" />\r\n              <view class=\"info-it\">{{ it.servType }}</view>\r\n              <nut-divider direction=\"vertical\" />\r\n              <view class=\"info-it\">{{ it.commentNum || 0 }} 条评价</view>\r\n            </view>\r\n            <view class=\"rate\">\r\n              <nut-rate\r\n                active-color=\"#FFC800\"\r\n                v-model=\"it.rate\"\r\n                icon-size=\"14\"\r\n                spacing=\"2\"\r\n                readonly\r\n              />\r\n            </view>\r\n          </view>\r\n          <view class=\"bottom\">\r\n            <nut-tag\r\n              v-if=\"it.verifed == 1\"\r\n              color=\"rgb(236, 128, 126)\"\r\n              text-color=\"#fff\"\r\n              class=\"tag\"\r\n            >\r\n              已认证\r\n            </nut-tag>\r\n            <!-- <nut-tag v-else color=\"#E9E9E9\" class=\"tag\">未认证</nut-tag> -->\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <view v-show=\"moreLoading\" class=\"footer\">\r\n        <nut-divider>加载中 ...</nut-divider>\r\n      </view>\r\n      <view v-show=\"!hasMore\" class=\"footer\">\r\n        <nut-divider>到底啦</nut-divider>\r\n      </view>\r\n    </scroll-view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { reactive, toRefs, onMounted } from \"vue\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport API from \"../../utils/api\";\r\n\r\nexport default {\r\n  name: \"Collection\",\r\n  components: {},\r\n  setup() {\r\n    const state = reactive({\r\n      myCollectPageParam: {},\r\n      myCollectPageRes: null,\r\n      dataList: [],\r\n      hasMore: true,\r\n      moreLoading: false,\r\n      touchstart: -1,\r\n    });\r\n\r\n    onMounted(async () => {\r\n      state.myCollectPageParam.pageNum = 1;\r\n      state.myCollectPageParam.pageSize = 20;\r\n      state.moreLoading = true;\r\n      API.requestAfterHandle(\r\n        await API.myCollectPage(state.myCollectPageParam),\r\n        (data) => {\r\n          state.myCollectPageRes = data;\r\n          state.dataList.splice(0, state.dataList.length);\r\n          state.dataList.push(...state.myCollectPageRes.records);\r\n          handleAfterSearch();\r\n        }\r\n      );\r\n      state.moreLoading = false;\r\n    });\r\n\r\n    const lower = () => {\r\n      if (!state.hasMore || state.moreLoading) {\r\n        return;\r\n      }\r\n      state.moreLoading = true;\r\n      state.myCollectPageParam.pageNum++;\r\n      state.dataList.push(...state.myCollectPageRes.records);\r\n      handleAfterSearch();\r\n      state.moreLoading = false;\r\n    };\r\n\r\n    const touchstart = (e) => {\r\n      state.touchstart = e.timeStamp;\r\n    };\r\n\r\n    const touchend = (e, it) => {\r\n      if (!state.touchstart || state.touchstart < 0) {\r\n        return;\r\n      }\r\n      if (e.timeStamp - state.touchstart > 500) {\r\n        Taro.showActionSheet({\r\n          itemList: [\"取消收藏\"],\r\n          success: async function (res) {\r\n            // 取消搜藏\r\n            if (res.tapIndex == 0) {\r\n              API.requestAfterHandle(await API.myDelCollect(it.ayId));\r\n              for (let i = 0; i < state.dataList.length; i++) {\r\n                if (state.dataList[i].id == it.id) {\r\n                  state.dataList.splice(i, 1);\r\n                }\r\n              }\r\n            }\r\n          },\r\n          fail: function (res) {\r\n            console.log(res.errMsg);\r\n          },\r\n        });\r\n      }\r\n      state.touchstart = -1;\r\n    };\r\n\r\n    const handleAfterSearch = () => {\r\n      if (state.myCollectPageRes.current >= state.myCollectPageRes.pages) {\r\n        state.hasMore = false;\r\n      }\r\n    };\r\n\r\n    const toAyDetail = (e) => {\r\n      Taro.navigateTo({\r\n        url: \"/pages/aydetail/index?id=\" + e.ayId,\r\n      });\r\n    };\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      lower,\r\n      touchstart,\r\n      touchend,\r\n      toAyDetail,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.collection {\r\n  height: 100%;\r\n  .list {\r\n    height: 100vh;\r\n\r\n    .it {\r\n      margin: 0rpx 30rpx;\r\n      padding: 30rpx 20rpx;\r\n      background: #fff;\r\n      border-radius: 20rpx;\r\n      display: flex;\r\n      margin-top: 20rpx;\r\n      box-sizing: border-box;\r\n\r\n      .left {\r\n        padding: 10rpx;\r\n        box-sizing: border-box;\r\n\r\n        .img {\r\n          width: 120rpx;\r\n          height: 120rpx;\r\n        }\r\n      }\r\n\r\n      .right {\r\n        padding-left: 30rpx;\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        justify-content: space-between;\r\n\r\n        .top {\r\n          display: flex;\r\n          flex-direction: column;\r\n          align-items: flex-start;\r\n\r\n          .name {\r\n            font-size: 28rpx;\r\n            font-weight: 600;\r\n          }\r\n\r\n          .info {\r\n            display: flex;\r\n            font-size: 22rpx;\r\n            padding-top: 8rpx;\r\n          }\r\n        }\r\n\r\n        .bottom {\r\n          .tag {\r\n            font-size: 22rpx;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .footer {\r\n      padding: 0 100rpx 20rpx 100rpx;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"我的收藏\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/collection/index', {root:{cn:[]}}, config || {}))\n\n\n","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=template&id=130d4e25&ts=true\""],"names":[],"sourceRoot":""}