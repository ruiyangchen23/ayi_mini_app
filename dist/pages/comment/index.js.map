{"version":3,"file":"pages/comment/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAaA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACqTA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAlCA;AAAA;AAAA;AAqCA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAPA;AAWA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AAMA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAIA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAMA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AACA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAjHA;AAAA;AAAA;AAmHA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;;;;;;;;;;;;;;;;;AA1vBA;AAAA;;;AACA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAUA;AAAA;;;AAQA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAUA;AAAA;;;AAQA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAUA;AAAA;;;AAmBA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAYA;AAAA;AAcA;AAAA;AAAA;AACA;AAAA;;AAEA;AAAA;;;AAaA;AAAA;;;AAeA;;;AACA;AAAA;;AACA;AAAA;;AACA;AAAA;;AACA;AAAA;;AACA;AAAA;;AAIA;AAAA;;AACA;AAAA;;AACA;AAAA;;AAIA;AAAA;;AACA;AAAA;AACA;AAAA;AAAA;;AACA;AAAA;;;AAcA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAUA;AAAA;;;AAmBA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAUA;AAAA;;;AASA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAYA;AAAA;;;AAQA;;;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;;AACA;AAAA;;;AAYA;;;AACA;AAAA;;AACA;AAAA;;;AAgBA;;;AACA;AAAA;;AACA;AAAA;;;AAgBA;;;AACA;AAAA;;AACA;AAAA;;;AAmBA;;;AACA;AAAA;AACA;AAAA;AAAA;;AAMA;AAAA;AAQA;AAAA;AAAA;AAAA;;;;;;;;;;AAtUA;AAUA;AAAA;AAKA;;AAAA;AAAA;AACA;AACA;AAIA;AASA;AAAA;AAKA;;AAAA;AAAA;AACA;AACA;AAIA;AASA;AAAA;AAKA;AACA;AAAA;;AAMA;AACA;;AAAA;AAAA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAKA;AAWA;AAAA;AAKA;AACA;AAAA;;AAMA;AACA;AACA;AACA;;AAEA;AAAA;AAIA;AAEA;AACA;;AAAA;;AAIA;AAAA;AAAA;AAEA;AAGA;AACA;AAAA;;;AAAA;AAAA;AAAA;AACA;AAAA;;;AAAA;AAAA;AAAA;;;AAGA;AACA;;AAAA;AAAA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAKA;AAMA;;AAAA;AAAA;AAAA;AAGA;AAGA;;AAAA;AAAA;AAAA;AAGA;AAKA;AACA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AACA;AAMA;AASA;AAAA;AAKA;AACA;AAAA;;AAMA;AACA;;AAAA;AAAA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAKA;AASA;AAAA;AAKA;AACA;;AAAA;AAAA;AACA;AACA;AAIA;AAWA;AAAA;AAKA;;AAAA;AAAA;AACA;AACA;AAIA;AAMA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAIA;AAIA;AACA;AAAA;AAAA;AAEA;AACA;;AAAA;AAAA;AACA;AACA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAIA;AAIA;AACA;AAAA;AAAA;AAEA;AACA;;AAAA;AAAA;AACA;AACA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAIA;AAGA;AAAA;;AAAA;AAAA;AAGA;AAyBA;AACA;;AAAA;AAAA;AAIA;AAAA;AAAA;;;AAAA;AAAA;;;;;;;;;;;;;;;ACtUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACPA","sources":["webpack://aydwj/./src/pages/comment/index.vue?01db","webpack://aydwj/._src_pages_comment_index.vue","webpack://aydwj/./src/pages/comment/index.vue?6694","webpack://aydwj/./src/pages/comment/index.vue?674f","webpack://aydwj/./src/pages/comment/index.vue?b793"],"sourcesContent":["import { render } from \"./index.vue?vue&type=template&id=5d716c4e&ts=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=5d716c4e&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\aligu\\\\Downloads\\\\miniapp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/comment/index.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"5d716c4e\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('5d716c4e', __exports__)) {\n    api.reload('5d716c4e', __exports__)\n  }\n  \n  module.hot.accept(\"./index.vue?vue&type=template&id=5d716c4e&ts=true\", () => {\n    api.rerender('5d716c4e', render)\n  })\n\n}\n\n\nexport default __exports__","<template>\r\n  <view class=\"comment\">\r\n    <view v-if=\"formItems[0].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[0].num }}) 姓 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.lastname.pattern.test(submitData.lastname)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.lastname.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input\r\n          v-model=\"submitData.lastname\"\r\n          placeholder=\"请输入阿姨的姓氏\"\r\n          :disabled=\"!!submitData.ayId\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[1].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[1].num }}) 名 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.firstname.pattern.test(submitData.firstname)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.firstname.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input\r\n          v-model=\"submitData.firstname\"\r\n          placeholder=\"请输入阿姨的名字\"\r\n          :disabled=\"!!submitData.ayId\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[2].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[2].num }}) 家乡 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.hometown.pattern.test(submitData.hometown)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.hometown.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.hometown || '家乡'\"\r\n          @click=\"\r\n            () => {\r\n              !!submitData.ayId ? null : (hometownShow = true);\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-picker\r\n          v-model=\"hometownArr\"\r\n          v-model:visible=\"hometownShow\"\r\n          :columns=\"servLocationColumns\"\r\n          title=\"家乡\"\r\n          @confirm=\"hometownConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[3].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[3].num }}) 服务地区 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.servLocation.pattern.test(\r\n            submitData.servLocation\r\n          )\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.servLocation.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servLocation || '服务地区'\"\r\n          @click=\"\r\n            () => {\r\n              servLocationShow = true;\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-popup\r\n          class=\"picker-item\"\r\n          position=\"bottom\"\r\n          :visible=\"servLocationVisible\"\r\n        >\r\n          <view class=\"head\">\r\n            <view class=\"title\">服务地区</view>\r\n          </view>\r\n          <view class=\"body\">\r\n            <view\r\n              v-for=\"(it, idx) in servLocationColumns\"\r\n              :key=\"idx\"\r\n              :class=\"{\r\n                item: true,\r\n                active: servLocationVal == it.value,\r\n              }\"\r\n              @click=\"() => (servLocationVal = it.value)\"\r\n            >\r\n              {{ it.text }}\r\n            </view>\r\n          </view>\r\n          <view class=\"foot\">\r\n            <view class=\"cancel\" @click=\"cancelServLocationVal\">取消</view>\r\n            <view class=\"confirm\" @click=\"servLocationConfirm\">确定</view>\r\n          </view>\r\n        </nut-popup>\r\n        <nut-picker\r\n          v-model=\"servLocationArr\"\r\n          v-model:visible=\"servLocationShow\"\r\n          :columns=\"servLocationColumns\"\r\n          title=\"服务地区\"\r\n          @confirm=\"servLocationConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[4].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[4].num }}) 阿姨的联系方式</view>\r\n      <view class=\"content\">\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">{{ formItems[4].num }}.1) 手机号码</view>\r\n          <view class=\"sub-content\">\r\n            <nut-input v-model=\"submitData.mobile\" placeholder=\"手机号码\" />\r\n          </view>\r\n        </view>\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">{{ formItems[4].num }}.2) 微信号</view>\r\n          <view class=\"sub-content\">\r\n            <nut-input v-model=\"submitData.wxcode\" placeholder=\"微信号\" />\r\n          </view>\r\n        </view>\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">{{ formItems[4].num }}.3) 微信二维码</view>\r\n          <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n          <view class=\"sub-content\">\r\n            <nut-uploader\r\n              :url=\"uploadUrl\"\r\n              maximum=\"1\"\r\n              v-model:file-list=\"wxqrcodeList\"\r\n              :headers=\"uploadHeaders\"\r\n              :with-credentials=\"true\"\r\n              :maximize=\"uploadMaximize\"\r\n              @success=\"wxqrcodeSuccess\"\r\n            ></nut-uploader>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[5].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[5].num }}) 服务类型 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.servType.pattern.test(submitData.servType)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.servType.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servType || '服务类型'\"\r\n          @click=\"\r\n            () => {\r\n              servTypeShow = true;\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-picker\r\n          v-model=\"servTypeArr\"\r\n          v-model:visible=\"servTypeShow\"\r\n          :columns=\"servTypeColumns\"\r\n          title=\"服务类型\"\r\n          @confirm=\"servTypeConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[6].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[6].num }}) 评分 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.rate.pattern.test(submitData.rate + '')\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.rate.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-rate\r\n          active-color=\"#FFC800\"\r\n          v-model=\"submitData.rate\"\r\n          icon-size=\"18\"\r\n          spacing=\"10\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[7].show\" class=\"row\">\r\n      <view class=\"title\"\r\n        >{{ formItems[7].num }}) 评价内容 <view class=\"require\">*</view></view\r\n      >\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.commentContent.pattern.test(\r\n            submitData.commentContent\r\n          )\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.commentContent.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-textarea\r\n          v-model=\"submitData.commentContent\"\r\n          limit-show\r\n          max-length=\"200\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[8].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[8].num }}) 图片分享</view>\r\n      <view class=\"desc descc-h\">如阿姨服务日常等</view>\r\n      <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n      <view class=\"content\">\r\n        <nut-uploader\r\n          :url=\"uploadUrl\"\r\n          v-model:file-list=\"imgList\"\r\n          maximum=\"3\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"imgSuccess\"\r\n        ></nut-uploader>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[9].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[9].num }}) 雇佣开始时间</view>\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servStartTime || '雇佣开始时间'\"\r\n          @click=\"() => (servStartTimeShow = true)\"\r\n        ></nut-cell>\r\n        <nut-datepicker\r\n          v-model=\"servStartTime\"\r\n          title=\"雇佣开始时间\"\r\n          type=\"date\"\r\n          v-model:visible=\"servStartTimeShow\"\r\n          :min-date=\"servMinDate\"\r\n          :max-date=\"servMaxDate\"\r\n          @confirm=\"servStartTimeConfirm\"\r\n        ></nut-datepicker>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[10].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[10].num }}) 雇佣结束时间</view>\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servEndTime || '雇佣结束时间'\"\r\n          @click=\"() => (servEndTimeShow = true)\"\r\n        ></nut-cell>\r\n        <nut-datepicker\r\n          v-model=\"servEndTime\"\r\n          title=\"雇佣结束时间\"\r\n          type=\"date\"\r\n          v-model:visible=\"servEndTimeShow\"\r\n          :min-date=\"servMinDate\"\r\n          :max-date=\"servMaxDate\"\r\n          @confirm=\"servEndTimeConfirm\"\r\n        ></nut-datepicker>\r\n      </view>\r\n    </view>\r\n    <view v-if=\"formItems[11].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[11].num }}) 佣金情况</view>\r\n      <view class=\"content\">\r\n        <nut-input placeholder=\"如10000/月\" v-model=\"submitData.payamountTxt\" />\r\n      </view>\r\n    </view>\r\n    <!-- <view class=\"row\">\r\n      <view class=\"title\">13) 雇佣证明</view>\r\n      <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n      <view class=\"content\">\r\n        <nut-uploader\r\n          :url=\"uploadUrl\"\r\n          v-model:file-list=\"hireProveImgsList\"\r\n          maximum=\"3\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"hireProveImgsSuccess\"\r\n        ></nut-uploader>\r\n      </view>\r\n    </view> -->\r\n    <view v-if=\"formItems[12].show\" class=\"row\">\r\n      <view class=\"title\">{{ formItems[12].num }}) 您的联系方式</view>\r\n      <view class=\"desc descc-h\">\r\n        <!-- We will use this email address to verify your identity if youwant to\r\n        update/delete the review in the futre. We may alsocontact this email if\r\n        we need more information regardingproof of employment. -->\r\n        <!-- 如果您未来希望删除或更改您的评论，我们会通过该邮箱来验证您的身份。 -->\r\n      </view>\r\n      <view class=\"content\">\r\n        <nut-input\r\n          placeholder=\"如: 手机号、微信号、电子邮箱等\"\r\n          v-model=\"submitData.email\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view class=\"row btn\" @click=\"submit\">\r\n      <view class=\"submit nut-button--primary\">提交</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { reactive, toRefs, ref, onMounted } from \"vue\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport API from \"../../utils/api\";\r\nimport Constants from \"../../utils/constants\";\r\nimport Util from \"../../utils/util\";\r\n\r\nexport default {\r\n  name: \"Comment\",\r\n  components: {},\r\n  setup() {\r\n    const state = reactive({\r\n      // $instance: null,\r\n      user: null,\r\n      servTypeColumns: ref(Constants.servTypeList()),\r\n      servTypeShow: false,\r\n      servTypeArr: [\"月嫂\"],\r\n      servLocationColumns: ref(Constants.locationList()),\r\n      servLocationShow: false,\r\n      servLocationArr: [\"北京\"],\r\n      hometownShow: false,\r\n      hometownArr: [\"北京\"],\r\n      servStartTimeShow: false,\r\n      servStartTime: null,\r\n      servEndTimeShow: false,\r\n      servEndTime: null,\r\n      uploadUrl: process.env.REQ_BASE_URL + \"/simple/file/upload\",\r\n      uploadHeaders: { \"miniapp-token\": \"\" },\r\n      uploadMaximize: 1024 * 1024 * 5,\r\n      imgList: reactive([]),\r\n      // hireProveImgsList: reactive([]),\r\n      wxqrcodeList: reactive([]),\r\n      submitData: {\r\n        id: \"\",\r\n        ayId: \"\",\r\n        lastname: \"\",\r\n        firstname: \"\",\r\n        hometown: \"北京\",\r\n        servLocation: \"北京\",\r\n        mobile: \"\",\r\n        wxcode: \"\",\r\n        wxqrcode: \"\",\r\n        servType: \"月嫂\",\r\n        rate: 5,\r\n        commentContent: \"\",\r\n        imgs: \"\",\r\n        servStartTime: null,\r\n        servEndTime: null,\r\n        // hireProveImgs: \"\",\r\n        payamountTxt: \"\",\r\n        email: \"\",\r\n      },\r\n      submitDataValidator: {\r\n        lastname: {\r\n          pattern: /\\S+/,\r\n          msg: \"请输入姓氏\",\r\n        },\r\n        firstname: {\r\n          pattern: /\\S+/,\r\n          msg: \"请输入名字\",\r\n        },\r\n        hometown: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择家乡\",\r\n        },\r\n        servLocation: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择服务地区\",\r\n        },\r\n        servType: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择服务类型\",\r\n        },\r\n        rate: {\r\n          pattern: /^[12345]$/,\r\n          msg: \"请打分\",\r\n        },\r\n        commentContent: {\r\n          pattern: /\\S+/,\r\n          msg: \"请录入评价内容\",\r\n        },\r\n      },\r\n      readySubmit: false,\r\n      getUserProfileLoading: false,\r\n      servMinDate: new Date(2000, 0, 1),\r\n      servMaxDate: new Date(),\r\n      formItems: [\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n        {\r\n          show: true,\r\n          num: 1,\r\n        },\r\n      ],\r\n    });\r\n\r\n    onMounted(async () => {\r\n      state.$instance = Taro.getCurrentInstance();\r\n      state.submitData.id = state.$instance.router.params.id;\r\n      if (state.submitData.id) {\r\n        API.requestAfterHandle(\r\n          await API.commentDetail(state.submitData.id),\r\n          (data) => {\r\n            state.submitData = data;\r\n            if (state.submitData.servType) {\r\n              state.servTypeArr = [state.submitData.servType];\r\n            }\r\n            if (state.submitData.servLocation) {\r\n              state.servLocationArr = [state.submitData.servLocation];\r\n            }\r\n            if (state.submitData.hometown) {\r\n              state.hometownArr = [state.submitData.hometown];\r\n            }\r\n            if (state.submitData.servStartTime) {\r\n              const servStartTime = new Date(state.submitData.servStartTime);\r\n              state.servStartTime = Util.splitDate(servStartTime);\r\n              state.submitData.servStartTime = Util.formatDate(servStartTime);\r\n            }\r\n            if (state.submitData.servEndTime) {\r\n              const servEndTime = new Date(state.submitData.servEndTime);\r\n              state.servEndTime = Util.splitDate(servEndTime);\r\n              state.submitData.servEndTime = Util.formatDate(servEndTime);\r\n            }\r\n            if (state.submitData.wxqrcode) {\r\n              state.wxqrcodeList.push(\r\n                ...Util.splitImgs(state.submitData.wxqrcode)\r\n              );\r\n            }\r\n            if (state.submitData.imgs) {\r\n              state.imgList.push(...Util.splitImgs(state.submitData.wxqrcode));\r\n            }\r\n            // if (state.submitData.hireProveImgs) {\r\n            //   state.hireProveImgsList.push(...Util.splitImgs(state.submitData.hireProveImgs));\r\n            // }\r\n          }\r\n        );\r\n      } else {\r\n        state.submitData.ayId = state.$instance.router.params.ayId;\r\n        if (state.submitData.ayId) {\r\n          // 渲染阿姨数据\r\n          API.requestAfterHandle(\r\n            await API.ayDetail(state.submitData.ayId),\r\n            (data) => {\r\n              state.submitData.ayId = data.id;\r\n              state.submitData.lastname = data.lastname;\r\n              state.submitData.firstname = data.firstname;\r\n              state.submitData.hometown = data.hometown;\r\n            }\r\n          );\r\n        }\r\n      }\r\n      state.user = Taro.getStorageSync(\"user\");\r\n      state.uploadHeaders[\"miniapp-token\"] = state.user?.token;\r\n\r\n      // 如果有阿姨ID，则隐藏某些输入框\r\n      if (state.submitData.ayId) {\r\n        state.formItems[3].show = false;\r\n        state.formItems[4].show = false;\r\n      }\r\n      let num = 1;\r\n      for (let i = 0; i < state.formItems.length; i++) {\r\n        if (state.formItems[i].show) {\r\n          state.formItems[i].num = num++;\r\n        }\r\n      }\r\n    });\r\n\r\n    const servTypeConfirm = (e) => {\r\n      state.submitData.servType = e.selectedValue[0];\r\n    };\r\n    const servLocationConfirm = (e) => {\r\n      state.submitData.servLocation = e.selectedValue[0];\r\n    };\r\n    const hometownConfirm = (e) => {\r\n      state.submitData.hometown = e.selectedValue[0];\r\n    };\r\n    const servStartTimeConfirm = (e) => {\r\n      state.submitData.servStartTime =\r\n        e.selectedValue[0] +\r\n        \"-\" +\r\n        e.selectedValue[1] +\r\n        \"-\" +\r\n        e.selectedValue[2];\r\n    };\r\n    const servEndTimeConfirm = (e) => {\r\n      state.submitData.servEndTime =\r\n        e.selectedValue[0] +\r\n        \"-\" +\r\n        e.selectedValue[1] +\r\n        \"-\" +\r\n        e.selectedValue[2];\r\n    };\r\n\r\n    const submit = async () => {\r\n      if (!getProfile()) return false;\r\n      state.readySubmit = true;\r\n      if (\r\n        !state.submitDataValidator.lastname.pattern.test(\r\n          state.submitData.lastname\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.lastname.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.firstname.pattern.test(\r\n          state.submitData.firstname\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.firstname.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.hometown.pattern.test(\r\n          state.submitData.hometown\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.hometown.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        state.formItems[3].show &&\r\n        !state.submitDataValidator.servLocation.pattern.test(\r\n          state.submitData.servLocation\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.servLocation.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.servType.pattern.test(\r\n          state.submitData.servType\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.servType.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.rate.pattern.test(state.submitData.rate + \"\")\r\n      ) {\r\n        submitWarning(state.submitDataValidator.rate.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.commentContent.pattern.test(\r\n          state.submitData.commentContent\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.commentContent.msg);\r\n        return false;\r\n      }\r\n      // 填充 & 校验\r\n      if (state.wxqrcodeList.length > 0) {\r\n        if (\r\n          state.wxqrcodeList.filter((item) => item.status != \"success\").length >\r\n          0\r\n        ) {\r\n          submitWarning(\"微信二维码未上传成功，请重试\");\r\n          return false;\r\n        }\r\n        state.submitData.wxqrcode = state.wxqrcodeList[0].url;\r\n      }\r\n      if (state.imgList.length > 0) {\r\n        if (\r\n          state.imgList.filter((item) => item.status != \"success\").length > 0\r\n        ) {\r\n          submitWarning(\"图片未上传成功，请重试\");\r\n          return false;\r\n        }\r\n        state.submitData.imgs = state.imgList.map((item) => item.url).join(\",\");\r\n      }\r\n      // if (state.hireProveImgsList.length > 0) {\r\n      //   if (\r\n      //     state.hireProveImgsList.filter((item) => item.status != \"success\")\r\n      //       .length > 0\r\n      //   ) {\r\n      //     submitWarning(\"雇佣证明未上传成功，请重试\");\r\n      //     return false;\r\n      //   }\r\n      //   state.submitData.hireProveImgs = state.hireProveImgsList\r\n      //     .map((item) => item.url)\r\n      //     .join(\",\");\r\n      // }\r\n      // 校验\r\n      console.log(\"提交数据：\", state.submitData);\r\n      Taro.showLoading({\r\n        title: \"提交中\",\r\n        mask: true,\r\n      });\r\n      const commentRes1 = API.requestAfterHandle(\r\n        await API.comment(state.submitData)\r\n      );\r\n      Taro.hideLoading();\r\n      if (commentRes1.msg == \"ok\") {\r\n        Taro.showToast({\r\n          title: \"提交成功\",\r\n          icon: \"success\",\r\n          duration: 2000,\r\n          mask: true,\r\n        });\r\n        setTimeout(() => {\r\n          Taro.switchTab({\r\n            url: \"/pages/index/index\",\r\n          });\r\n        }, 2000);\r\n      }\r\n    };\r\n\r\n    const imgSuccess = (e) => {\r\n      state.imgList[state.imgList.length - 1].url = JSON.parse(\r\n        e.responseText.data\r\n      ).data;\r\n    };\r\n    // const hireProveImgsSuccess = (e) => {\r\n    //   state.hireProveImgsList[state.hireProveImgsList.length - 1].url =\r\n    //     JSON.parse(e.responseText.data).data;\r\n    // };\r\n    const wxqrcodeSuccess = (e) => {\r\n      state.wxqrcodeList[state.wxqrcodeList.length - 1].url = JSON.parse(\r\n        e.responseText.data\r\n      ).data;\r\n    };\r\n\r\n    const getProfile = () => {\r\n      if (state.user?.authProfile) {\r\n        return true;\r\n      }\r\n      if (state.getUserProfileLoading) {\r\n        return false;\r\n      }\r\n      state.getUserProfileLoading = true;\r\n      const pLogin = new Promise((resolve, reject) => {\r\n        Taro.login({\r\n          success: function (res) {\r\n            resolve(res.code);\r\n          },\r\n        });\r\n      });\r\n      const pUserProfile = new Promise((resolve, reject) => {\r\n        Taro.getUserProfile({\r\n          // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写\r\n          desc: \"用于完善用户资料\",\r\n          success: (profile) => {\r\n            resolve(profile);\r\n          },\r\n        });\r\n      });\r\n      Promise.all([pLogin, pUserProfile]).then(async (values) => {\r\n        API.requestAfterHandle(\r\n          await API.authLogin(values[0], values[1].encryptedData, values[1].iv),\r\n          (data) => {\r\n            Taro.setStorageSync(\"user\", state.user);\r\n            state.user = data;\r\n          }\r\n        );\r\n        state.getUserProfileLoading = false;\r\n      });\r\n      return false;\r\n    };\r\n\r\n    const submitWarning = (txt) => {\r\n      Taro.showToast({\r\n        title: txt,\r\n        icon: \"error\",\r\n        duration: 1500,\r\n      });\r\n    };\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      submit,\r\n      servTypeConfirm,\r\n      servLocationConfirm,\r\n      hometownConfirm,\r\n      servStartTimeConfirm,\r\n      servEndTimeConfirm,\r\n      imgSuccess,\r\n      // hireProveImgsSuccess,\r\n      wxqrcodeSuccess,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.comment {\r\n  margin: 0 30rpx 30rpx 30rpx;\r\n\r\n  .row {\r\n    margin-top: 30rpx;\r\n    background: #fff;\r\n    border-radius: 20rpx;\r\n    padding: 20rpx;\r\n\r\n    .title {\r\n      font-size: 28rpx;\r\n      line-height: 1.2rem;\r\n      display: flex;\r\n\r\n      .require {\r\n        color: red;\r\n        padding-left: 6rpx;\r\n      }\r\n    }\r\n\r\n    .desc {\r\n      font-size: 20rpx;\r\n      line-height: 0.8rem;\r\n      margin-top: 10rpx;\r\n    }\r\n\r\n    .err {\r\n      font-size: 20rpx;\r\n      line-height: 0.8rem;\r\n      margin-top: 10rpx;\r\n      color: red;\r\n    }\r\n\r\n    .content {\r\n      padding-top: 20rpx;\r\n\r\n      .nut-textarea,\r\n      .nut-input {\r\n        padding: 0;\r\n      }\r\n\r\n      .sub-row {\r\n        padding: 20rpx;\r\n        .sub-title {\r\n          font-size: 24rpx;\r\n        }\r\n        .sub-content {\r\n          padding-top: 10rpx;\r\n        }\r\n      }\r\n    }\r\n\r\n    &.btn {\r\n      background: rgba($color: #000000, $alpha: 0);\r\n      padding: 0 0 20rpx 0;\r\n\r\n      .submit {\r\n        font-size: 28rpx;\r\n        // background: #1d6308;\r\n        border-radius: 20rpx;\r\n        text-align: center;\r\n        height: 70rpx;\r\n        line-height: 70rpx;\r\n        // color: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"点评阿姨\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/comment/index', {root:{cn:[]}}, config || {}))\n\n\n","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=template&id=5d716c4e&ts=true\""],"names":[],"sourceRoot":""}