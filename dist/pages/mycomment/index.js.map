{"version":3,"file":"pages/mycomment/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAaA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACoGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AArBA;AAAA;AAAA;AAuBA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAZA;AAAA;AAAA;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;;;;;;;;;;;;;;;;;AAlPA;AAAA;;;;AAYA;AAAA;;;AAGA;AAAA;;AACA;AAAA;;AACA;AAAA;;AAGA;AAAA;;AAEA;AAAA;;AACA;AAAA;;AAOA;AAAA;;AAUA;AAAA;;;AAWA;;;;AASA;AAAA;;AACA;AAAA;;;AAIA;;;AAoBA;AAAA;;AAGA;AAAA;;AAWA;AAAA;;;;;;;;AAnGA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAEA;AAUA;AAAA;AAEA;AAAA;;AAIA;AAAA;;AAAA;AAAA;;;AAGA;;AAAA;AAAA;;AAAA;AAAA;;;AAGA;;AAAA;;AAAA;AAAA;;;AAGA;AAEA;AACA;;AAAA;AAAA;AACA;AACA;AACA;AAKA;AACA;AAEA;AACA;AAEA;AAAA;AAAA;;AAGA;;AASA;AACA;AACA;AAAA;AAAA;;AACA;AAAA;;;AAIA;;AACA;AACA;AACA;AAAA;AAAA;;AACA;AAAA;;;;AAKA;AACA;AAAA;;;AADA;AAIA;AAAA;;;AADA;AAOA;AACA;AAAA;AAAA;AAAA;AACA;;AAAA;AAAA;;AAEA;AAAA;AAEA;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAKA;AACA;;AACA;AAAA;;;AANA;;;;;;;;;;;;;;;;;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACPA","sources":["webpack://aydwj/./src/pages/mycomment/index.vue?304a","webpack://aydwj/._src_pages_mycomment_index.vue","webpack://aydwj/./src/pages/mycomment/index.vue?9202","webpack://aydwj/./src/pages/mycomment/index.vue?9b49","webpack://aydwj/./src/pages/mycomment/index.vue?15b0"],"sourcesContent":["import { render } from \"./index.vue?vue&type=template&id=0186d722\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=0186d722&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\aligu\\\\Downloads\\\\miniapp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/mycomment/index.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"0186d722\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('0186d722', __exports__)) {\n    api.reload('0186d722', __exports__)\n  }\n  \n  module.hot.accept(\"./index.vue?vue&type=template&id=0186d722\", () => {\n    api.rerender('0186d722', render)\n  })\n\n}\n\n\nexport default __exports__","<template>\r\n  <view class=\"mycomment\">\r\n    <scroll-view\r\n      class=\"list\"\r\n      :scroll-y=\"true\"\r\n      @scrolltoupper=\"upper\"\r\n      @scrolltolower=\"lower\"\r\n      @scroll=\"scroll\"\r\n      :scroll-into-view=\"toView\"\r\n      :scroll-top=\"scrollTop\"\r\n    >\r\n      <view v-for=\"(it, idx) in list\" :key=\"idx\" class=\"item bgc-w\">\r\n        <view class=\"ay\" @click=\"toAyDetail(it)\">\r\n          <view class=\"left\">\r\n            <img class=\"avatar\" :src=\"it.ayAvatar\" />\r\n          </view>\r\n          <view class=\"right\">\r\n            <view class=\"nameandtime\">\r\n              <view class=\"name\"\r\n                >{{ it.ayLastname }}{{ it.ayFirstname || \"阿姨\" }}</view\r\n              >\r\n              <view class=\"time\">{{ it.createTimeStr }}</view>\r\n            </view>\r\n            <view class=\"other\">\r\n              <view class=\"other-left\">\r\n                <view>{{ it.ayServLocation }}</view>\r\n                <nut-divider direction=\"vertical\" />\r\n                <view>{{ it.ayServType }}</view>\r\n                <nut-divider direction=\"vertical\" />\r\n                <view>{{ it.ayCommentNum || 0 }} 条评价</view>\r\n              </view>\r\n              <view class=\"other-right\">\r\n                <nut-tag v-if=\"it.approvalStatus == 1\" type=\"success\" plain>\r\n                  审核通过\r\n                </nut-tag>\r\n                <nut-tag v-else-if=\"it.approvalStatus == 2\" type=\"danger\" plain>\r\n                  审核驳回\r\n                </nut-tag>\r\n                <nut-tag v-else plain>待审核</nut-tag>\r\n              </view>\r\n            </view>\r\n            <view class=\"rate\">\r\n              <nut-rate\r\n                active-color=\"#FFC800\"\r\n                v-model=\"it.rate\"\r\n                icon-size=\"14\"\r\n                spacing=\"6\"\r\n                disabled\r\n              />\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <view v-if=\"it.imgList && it.imgList.length > 0\" class=\"imgs\">\r\n          <view\r\n            v-for=\"(imgIt, imgIdx) in it.imgList\"\r\n            :key=\"imgIdx\"\r\n            class=\"img-it\"\r\n          >\r\n            <img class=\"img\" :src=\"imgIt\" />\r\n          </view>\r\n        </view>\r\n        <view class=\"content\">\r\n          <view class=\"value valc-h\">{{ it.commentContent }}</view>\r\n        </view>\r\n        <view\r\n          v-if=\"it.approvalStatus == 1 || it.approvalStatus == 2\"\r\n          class=\"operations\"\r\n        >\r\n          <nut-tag\r\n            v-if=\"it.approvalStatus == 1\"\r\n            plain\r\n            color=\"rgb(236, 128, 126)\"\r\n            @click=\"replycommentPopupShow(it)\"\r\n          >\r\n            追评\r\n          </nut-tag>\r\n          <nut-tag\r\n            v-if=\"it.approvalStatus == 2\"\r\n            plain\r\n            color=\"rgb(236, 128, 126)\"\r\n            @click=\"toComment(it)\"\r\n          >\r\n            修改\r\n          </nut-tag>\r\n        </view>\r\n      </view>\r\n      <view v-show=\"moreLoading\" class=\"footer\">\r\n        <nut-divider>加载中...</nut-divider>\r\n      </view>\r\n      <view v-show=\"!hasMore\" class=\"footer\">\r\n        <nut-divider>到底啦</nut-divider>\r\n      </view>\r\n    </scroll-view>\r\n  </view>\r\n\r\n  <nut-popup\r\n    position=\"bottom\"\r\n    :style=\"{ padding: '20rpx', boxSizing: 'border-box' }\"\r\n    v-model:visible=\"replycommentPopupVisible\"\r\n  >\r\n    <view class=\"reply-container\">\r\n      <nut-input\r\n        v-model=\"replycommentSubmitData.content\"\r\n        type=\"textarea\"\r\n        show-word-limit\r\n        rows=\"2\"\r\n        max-length=\"150\"\r\n        placeholder=\"追评\"\r\n      />\r\n      <nut-button\r\n        v-show=\"\r\n          replycommentSubmitData.content &&\r\n          replycommentSubmitData.content.length > 0\r\n        \"\r\n        type=\"primary\"\r\n        @click=\"replycommentSubmit\"\r\n      >\r\n        追评\r\n      </nut-button>\r\n    </view>\r\n  </nut-popup>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, toRefs, onMounted } from \"vue\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport API from \"../../utils/api\";\r\n\r\nexport default {\r\n  name: \"Mycomment\",\r\n  components: {},\r\n  setup() {\r\n    const state = reactive({\r\n      myCommentPageParam: {},\r\n      myCommentPageRes: null,\r\n      list: [],\r\n      hasMore: true,\r\n      moreLoading: false,\r\n      replycommentPopupVisible: false,\r\n      replycommentSubmitData: {\r\n        ayId: \"\",\r\n        commentId: \"\",\r\n        content: \"\",\r\n      },\r\n    });\r\n\r\n    onMounted(async () => {\r\n      state.myCommentPageParam.pageNum = 1;\r\n      state.myCommentPageParam.pageSize = 20;\r\n      state.moreLoading = true;\r\n      API.requestAfterHandle(\r\n        await API.myCommentPage(state.myCommentPageParam),\r\n        (data) => {\r\n          for (const it of data.records) {\r\n            if (it.imgs && it.imgs.indexOf(\",\") > -1) {\r\n              it.imgList = it.imgs.split(\",\");\r\n            }\r\n            it.createTimeStr = API.timeTxt(it.createTime);\r\n          }\r\n          state.myCommentPageRes = data;\r\n          state.list.splice(0, state.list.length);\r\n          state.list.push(...state.myCommentPageRes.records);\r\n          handleAfterSearch();\r\n        }\r\n      );\r\n      state.moreLoading = false;\r\n\r\n      API.requestAfterHandle(await API.readAll(\"4\"));\r\n      API.requestAfterHandle(await API.countUnread(), (data) => {\r\n        Taro.setStorageSync(\"unreadCount\", data || []);\r\n      });\r\n    });\r\n\r\n    const lower = async () => {\r\n      if (!state.hasMore || state.moreLoading) {\r\n        return;\r\n      }\r\n      state.moreLoading = true;\r\n      state.myCommentPageParam.pageNum++;\r\n      API.requestAfterHandle(\r\n        await API.myCommentPage(state.myCommentPageParam),\r\n        (data) => {\r\n          for (const it of data.records) {\r\n            if (it.imgs && it.imgs.indexOf(\",\") > -1) {\r\n              it.imgList = it.imgs.split(\",\");\r\n            }\r\n            it.createTimeStr = API.timeTxt(it.createTime);\r\n          }\r\n          state.myCommentPageRes = data;\r\n          state.list.push(...state.myCommentPageRes.records);\r\n          handleAfterSearch();\r\n        }\r\n      );\r\n      state.moreLoading = false;\r\n    };\r\n\r\n    const handleAfterSearch = () => {\r\n      if (state.myCommentPageRes.current >= state.myCommentPageRes.pages) {\r\n        state.hasMore = false;\r\n      }\r\n    };\r\n\r\n    const replycommentPopupShow = (e) => {\r\n      state.replycommentSubmitData.ayId = e.ayId;\r\n      state.replycommentSubmitData.commentId = e.id;\r\n      state.replycommentSubmitData.content = \"\";\r\n\r\n      state.replycommentPopupVisible = true;\r\n    };\r\n    const replycommentSubmit = async () => {\r\n      API.requestAfterHandle(\r\n        await API.replycomment(state.replycommentSubmitData),\r\n        () => {\r\n          Taro.showToast({\r\n            title: \"追评成功\",\r\n            icon: \"success\",\r\n            duration: 1500,\r\n          });\r\n        }\r\n      );\r\n      state.replycommentPopupVisible = false;\r\n    };\r\n\r\n    const toAyDetail = (e) => {\r\n      Taro.navigateTo({\r\n        url: \"/pages/aydetail/index?id=\" + e.ayId,\r\n      });\r\n    };\r\n    const toComment = (e) => {\r\n      Taro.redirectTo({\r\n        url: \"/pages/comment/index?id=\" + e.id,\r\n      });\r\n    };\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      lower,\r\n      replycommentPopupShow,\r\n      replycommentSubmit,\r\n      toAyDetail,\r\n      toComment,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.mycomment {\r\n  height: 100%;\r\n  .list {\r\n    height: 100vh;\r\n\r\n    .item {\r\n      margin-top: 30rpx;\r\n      margin-left: 30rpx;\r\n      margin-right: 30rpx;\r\n      display: flex;\r\n      flex-direction: column;\r\n      border-radius: 20rpx;\r\n      padding: 20rpx;\r\n      line-height: 1.6rem;\r\n\r\n      .ay {\r\n        display: flex;\r\n\r\n        .left {\r\n          .avatar {\r\n            width: 100rpx;\r\n            height: 100rpx;\r\n          }\r\n        }\r\n\r\n        .right {\r\n          margin-left: 20rpx;\r\n          font-size: 22rpx;\r\n          width: 100%;\r\n\r\n          .nameandtime {\r\n            font-size: 28rpx;\r\n            display: flex;\r\n            justify-content: space-between;\r\n\r\n            .name {\r\n              font-weight: 600;\r\n            }\r\n\r\n            .time {\r\n              color: #555555;\r\n              font-size: 24rpx;\r\n            }\r\n          }\r\n\r\n          .other {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n\r\n            .other-left {\r\n              display: flex;\r\n              align-items: center;\r\n            }\r\n\r\n            .other-right {\r\n              .nut-tag {\r\n                font-size: 20rpx;\r\n                line-height: 1rem;\r\n              }\r\n            }\r\n          }\r\n\r\n          .rateandtime {\r\n            display: flex;\r\n            align-items: center;\r\n            width: 100%;\r\n            justify-content: space-between;\r\n          }\r\n        }\r\n      }\r\n\r\n      .label {\r\n        font-size: 26rpx;\r\n        font-weight: 500;\r\n      }\r\n\r\n      .value {\r\n        font-size: 24rpx;\r\n      }\r\n\r\n      .rateandtime {\r\n        display: flex;\r\n        justify-content: space-between;\r\n\r\n        .rate {\r\n          display: flex;\r\n        }\r\n      }\r\n\r\n      .serv-type {\r\n        display: flex;\r\n      }\r\n\r\n      .imgs {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n\r\n        .img-it {\r\n          padding: 10rpx;\r\n          margin: 10rpx;\r\n\r\n          .img {\r\n            width: 80rpx;\r\n            height: 80rpx;\r\n          }\r\n        }\r\n      }\r\n\r\n      .operations {\r\n        text-align: right;\r\n        // color: #555555;\r\n        color: rgb(236, 128, 126);\r\n        font-size: 24rpx;\r\n        text-align: right;\r\n      }\r\n    }\r\n\r\n    .footer {\r\n      padding: 0 100rpx 20rpx 100rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.reply-container {\r\n  display: flex;\r\n  align-items: flex-end;\r\n}\r\n</style>\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"我的评价\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/mycomment/index', {root:{cn:[]}}, config || {}))\n\n\n","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=js\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=js\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=template&id=0186d722\""],"names":[],"sourceRoot":""}