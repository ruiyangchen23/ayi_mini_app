{"version":3,"file":"pages/aycert/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAaA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;AC+QA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAIA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AASA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AASA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AAA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","sources":["webpack://aydwj/./src/pages/aycert/index.vue?7f2f","webpack://aydwj/._src_pages_aycert_index.vue","webpack://aydwj/./src/pages/aycert/index.vue?7970","webpack://aydwj/./src/pages/aycert/index.vue?03a9","webpack://aydwj/./src/pages/aycert/index.vue?09bd"],"sourcesContent":["import { render } from \"./index.vue?vue&type=template&id=8a0fcb3a&ts=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=8a0fcb3a&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\aligu\\\\Downloads\\\\miniapp\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/aycert/index.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"8a0fcb3a\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('8a0fcb3a', __exports__)) {\n    api.reload('8a0fcb3a', __exports__)\n  }\n  \n  module.hot.accept(\"./index.vue?vue&type=template&id=8a0fcb3a&ts=true\", () => {\n    api.rerender('8a0fcb3a', render)\n  })\n\n}\n\n\nexport default __exports__","<template>\r\n  <view class=\"aycert\">\r\n    <view class=\"row\">\r\n      <view class=\"title\">1) 姓 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.lastname.pattern.test(submitData.lastname)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.lastname.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input v-model=\"submitData.lastname\" placeholder=\"请输入姓氏\" />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">2) 名 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.firstname.pattern.test(submitData.firstname)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.firstname.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input v-model=\"submitData.firstname\" placeholder=\"请输入名字\" />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">3) 出生年份 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.birthDate.pattern.test(submitData.birthDate)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.birthDate.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input\r\n          v-model=\"submitData.birthDate\"\r\n          placeholder=\"请输入出生年份，例如1900\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">4) 家乡 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.hometown.pattern.test(submitData.hometown)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.hometown.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.hometown || '家乡'\"\r\n          @click=\"\r\n            () => {\r\n              hometownShow = true;\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-picker\r\n          v-model=\"hometownArr\"\r\n          v-model:visible=\"hometownShow\"\r\n          :columns=\"servLocationColumns\"\r\n          title=\"家乡\"\r\n          @confirm=\"hometownConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">5) 服务地区 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.servLocation.pattern.test(\r\n            submitData.servLocation\r\n          )\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.servLocation.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servLocation || '服务地区'\"\r\n          @click=\"\r\n            () => {\r\n              servLocationShow = true;\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-picker\r\n          v-model=\"servLocationArr\"\r\n          v-model:visible=\"servLocationShow\"\r\n          :columns=\"servLocationColumns\"\r\n          title=\"服务地区\"\r\n          @confirm=\"servLocationConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">6) 服务起始年份 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.servStartYear.pattern.test(\r\n            submitData.servStartYear\r\n          )\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.servStartYear.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input\r\n          v-model=\"submitData.servStartYear\"\r\n          placeholder=\"请输入服务起始年份\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">7) 服务类型 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.servType.pattern.test(submitData.servType)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.servType.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-cell\r\n          :title=\"submitData.servType || '服务类型'\"\r\n          @click=\"\r\n            () => {\r\n              servTypeShow = true;\r\n            }\r\n          \"\r\n        ></nut-cell>\r\n        <nut-picker\r\n          v-model=\"servTypeArr\"\r\n          v-model:visible=\"servTypeShow\"\r\n          :columns=\"servTypeColumns\"\r\n          title=\"服务类型\"\r\n          @confirm=\"servTypeConfirm\"\r\n        >\r\n        </nut-picker>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">8) 自我介绍 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit && !submitDataValidator.info.pattern.test(submitData.info)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.info.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-textarea v-model=\"submitData.info\" limit-show max-length=\"200\" />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">9) 图片展示</view>\r\n      <view class=\"desc descc-h\">如相关证书、服务日常等</view>\r\n      <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n      <view class=\"content\">\r\n        <nut-uploader\r\n          :url=\"uploadUrl\"\r\n          v-model:file-list=\"imgsList\"\r\n          maximum=\"3\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"imgsSuccess\"\r\n        ></nut-uploader>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">10) 实名认证 <view class=\"require\">*</view></view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.idnum.pattern.test(submitData.idnum)\r\n        \"\r\n        class=\"err\"\r\n        >{{ submitDataValidator.idnum.msg }}</view\r\n      >\r\n      <view class=\"content\">\r\n        <nut-input\r\n          v-model=\"submitData.idnum\"\r\n          placeholder=\"请输入阿姨的身份证号码\"\r\n        />\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">11) 身份证照片</view>\r\n      <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n      <view class=\"content\">\r\n        <!-- <nut-uploader\r\n          :url=\"privateUploadUrl\"\r\n          v-model:file-list=\"idnumImgsList\"\r\n          maximum=\"2\"\r\n          multiple\r\n          list-type=\"list\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"idnumImgsSuccess\"\r\n        >\r\n          <nut-button type=\"success\" size=\"small\">上传身份证</nut-button>\r\n        </nut-uploader> -->\r\n        <nut-uploader\r\n          :url=\"privateUploadUrl\"\r\n          v-model:file-list=\"idnumImgsList\"\r\n          maximum=\"2\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"idnumImgsSuccess\"\r\n        ></nut-uploader>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">12) 联系方式 <view class=\"require\">*</view></view>\r\n      <view class=\"desc descc-h\">请至少填写一种</view>\r\n      <view\r\n        v-show=\"\r\n          readySubmit &&\r\n          !submitDataValidator.contact.pattern.test(submitData.mobile) &&\r\n          !submitDataValidator.contact.pattern.test(submitData.wxcode) &&\r\n          wxqrcodeList.length < 1\r\n        \"\r\n        class=\"err\"\r\n      >\r\n        {{ submitDataValidator.contact.msg }}\r\n      </view>\r\n      <view class=\"content\">\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">12.1) 手机号码</view>\r\n          <view class=\"sub-content\">\r\n            <nut-input v-model=\"submitData.mobile\" placeholder=\"手机号码\" />\r\n          </view>\r\n        </view>\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">12.2) 微信号</view>\r\n          <view class=\"sub-content\">\r\n            <nut-input v-model=\"submitData.wxcode\" placeholder=\"微信号\" />\r\n          </view>\r\n        </view>\r\n        <view class=\"sub-row\">\r\n          <view class=\"sub-title\">12.3) 微信二维码</view>\r\n          <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n          <view class=\"sub-content\">\r\n            <nut-uploader\r\n              :url=\"uploadUrl\"\r\n              maximum=\"1\"\r\n              v-model:file-list=\"wxqrcodeList\"\r\n              :headers=\"uploadHeaders\"\r\n              :with-credentials=\"true\"\r\n              :maximize=\"uploadMaximize\"\r\n              @success=\"wxqrcodeSuccess\"\r\n            ></nut-uploader>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view class=\"row\">\r\n      <view class=\"title\">13) 上传头像</view>\r\n      <view class=\"desc descc-h\"> 单张图片大小不能大于5M </view>\r\n      <view class=\"content\">\r\n        <nut-uploader\r\n          :url=\"uploadUrl\"\r\n          v-model:file-list=\"avatarList\"\r\n          maximum=\"1\"\r\n          :headers=\"uploadHeaders\"\r\n          :with-credentials=\"true\"\r\n          :maximize=\"uploadMaximize\"\r\n          @success=\"avatarSuccess\"\r\n        ></nut-uploader>\r\n      </view>\r\n    </view>\r\n    <view class=\"row btn\" @click=\"submit\">\r\n      <view class=\"submit nut-button--primary\">提交</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { reactive, toRefs, ref, onMounted } from \"vue\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport API from \"../../utils/api\";\r\nimport Constants from \"../../utils/constants\";\r\nimport Util from \"../../utils/util\";\r\n\r\nexport default {\r\n  name: \"Comment\",\r\n  components: {},\r\n  setup() {\r\n    const state = reactive({\r\n      $instance: null,\r\n      user: null,\r\n      servTypeColumns: ref(Constants.servTypeList()),\r\n      servTypeShow: false,\r\n      servTypeArr: [\"月嫂\"],\r\n      servLocationColumns: ref(Constants.locationList()),\r\n      servLocationShow: false,\r\n      servLocationArr: [\"北京\"],\r\n      hometownShow: false,\r\n      hometownArr: [\"北京\"],\r\n      servStartTimeShow: false,\r\n      servEndTimeShow: false,\r\n      uploadUrl: process.env.REQ_BASE_URL + \"/simple/file/upload\",\r\n      privateUploadUrl:\r\n        process.env.REQ_BASE_URL + \"/simple/file/private-upload\",\r\n      uploadHeaders: { \"miniapp-token\": \"\" },\r\n      uploadMaximize: 1024 * 1024 * 5,\r\n      wxqrcodeList: reactive([]),\r\n      imgsList: reactive([]),\r\n      idnumImgsList: reactive([]),\r\n      avatarList: reactive([]),\r\n      submitData: {\r\n        ayId: \"\",\r\n        lastname: \"\",\r\n        firstname: \"\",\r\n        hometown: \"北京\",\r\n        age: \"\",\r\n        birthDate: \"\",\r\n        servLocation: \"北京\",\r\n        // servYear: null,\r\n        servStartYear: \"\",\r\n        servType: \"月嫂\",\r\n        mobile: \"\",\r\n        wxcode: \"\",\r\n        wxqrcode: \"\",\r\n        info: \"\",\r\n        imgs: \"\",\r\n        idnum: \"\",\r\n        idnumImgs: \"\",\r\n        avatar: \"\",\r\n        type: \"\",\r\n      },\r\n      submitDataValidator: {\r\n        lastname: {\r\n          pattern: /\\S+/,\r\n          msg: \"请输入姓氏\",\r\n        },\r\n        firstname: {\r\n          pattern: /\\S+/,\r\n          msg: \"请输入名字\",\r\n        },\r\n        hometown: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择家乡\",\r\n        },\r\n        // age: {\r\n        //   pattern: /^[1-9]+[0-9]*$/,\r\n        //   msg: \"请填写年龄\",\r\n        // },\r\n        birthDate: {\r\n          pattern: /^\\d{4}$/,\r\n          msg: \"请填写正确的出生年份\",\r\n        },\r\n        // servYear: {\r\n        //   pattern: /\\S+/,\r\n        //   msg: \"请选择服务年限\",\r\n        // },\r\n        servStartYear: {\r\n          pattern: /^\\d{4}$/,\r\n          msg: \"请选择服务起始年份\",\r\n        },\r\n        servLocation: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择服务地区\",\r\n        },\r\n        servType: {\r\n          pattern: /\\S+/,\r\n          msg: \"请选择服务类型\",\r\n        },\r\n        contact: {\r\n          pattern: /\\S+/,\r\n          msg: \"请至少填写一种联系方式\",\r\n        },\r\n        info: {\r\n          pattern: /\\S+/,\r\n          msg: \"请填写自我介绍\",\r\n        },\r\n        idnum: {\r\n          pattern:\r\n            /^[1-9]\\d{5}(18|19|20|(3\\d))\\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$/,\r\n          msg: \"请填写实名认证信息\",\r\n        },\r\n      },\r\n      readySubmit: false,\r\n      getUserProfileLoading: false,\r\n    });\r\n\r\n    onMounted(() => {\r\n      state.user = Taro.getStorageSync(\"user\");\r\n      state.uploadHeaders[\"miniapp-token\"] = state.user.token;\r\n      state.$instance = Taro.getCurrentInstance();\r\n      state.submitData.ayId = state.$instance.router.params.id;\r\n      state.submitData.type = state.$instance.router.params.type;\r\n      const certId = state.$instance.router.params.certId;\r\n      if (certId) {\r\n        API.myCert().then((myCertRes) => {\r\n          API.requestAfterHandle(myCertRes, (data) => {\r\n            Object.assign(state.submitData, data);\r\n            // state.submitData.id = certId;\r\n            state.submitData.idnumImgs = \"\";\r\n            if (state.submitData.servType) {\r\n              state.servTypeArr = [state.submitData.servType];\r\n            }\r\n            if (state.submitData.servLocation) {\r\n              state.servLocationArr = [state.submitData.servLocation];\r\n            }\r\n            if (state.submitData.hometown) {\r\n              state.hometownArr = [state.submitData.hometown];\r\n            }\r\n            if (state.submitData.wxqrcode) {\r\n              state.wxqrcodeList.push(\r\n                ...Util.splitImgs(state.submitData.wxqrcode)\r\n              );\r\n            }\r\n            if (state.submitData.imgs) {\r\n              state.imgsList.push(...Util.splitImgs(state.submitData.imgs));\r\n            }\r\n            if (state.submitData.avatar) {\r\n              state.avatarList.push(...Util.splitImgs(state.submitData.avatar));\r\n            }\r\n          });\r\n        });\r\n        return;\r\n      }\r\n    });\r\n\r\n    const servTypeConfirm = (e) => {\r\n      state.submitData.servType = e.selectedValue[0];\r\n    };\r\n    const servLocationConfirm = (e) => {\r\n      state.submitData.servLocation = e.selectedValue[0];\r\n    };\r\n    const hometownConfirm = (e) => {\r\n      state.submitData.hometown = e.selectedValue[0];\r\n    };\r\n\r\n    const submit = async () => {\r\n      if (!getProfile()) return false;\r\n      state.readySubmit = true;\r\n      if (\r\n        !state.submitDataValidator.lastname.pattern.test(\r\n          state.submitData.lastname\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.lastname.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.firstname.pattern.test(\r\n          state.submitData.firstname\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.firstname.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.hometown.pattern.test(\r\n          state.submitData.hometown\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.hometown.msg);\r\n        return false;\r\n      }\r\n      // if (!state.submitDataValidator.age.pattern.test(state.submitData.age)) {\r\n      //   submitWarning(state.submitDataValidator.age.msg);\r\n      //   return false;\r\n      // }\r\n      if (\r\n        !state.submitDataValidator.birthDate.pattern.test(\r\n          state.submitData.birthDate\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.birthDate.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.servLocation.pattern.test(\r\n          state.submitData.servLocation\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.servLocation.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.contact.pattern.test(\r\n          state.submitData.mobile\r\n        ) &&\r\n        !state.submitDataValidator.contact.pattern.test(\r\n          state.submitData.wxcode\r\n        ) &&\r\n        state.wxqrcodeList.length < 1\r\n      ) {\r\n        submitWarning(state.submitDataValidator.contact.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.servStartYear.pattern.test(\r\n          state.submitData.servStartYear\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.servStartYear.msg);\r\n        return false;\r\n      }\r\n      if (\r\n        !state.submitDataValidator.servType.pattern.test(\r\n          state.submitData.servType\r\n        )\r\n      ) {\r\n        submitWarning(state.submitDataValidator.servType.msg);\r\n        return false;\r\n      }\r\n      if (!state.submitDataValidator.idnum.pattern.test(state.submitData.idnum))\r\n        return false;\r\n      // 填充 & 校验\r\n      if (state.wxqrcodeList.length > 0) {\r\n        if (\r\n          state.wxqrcodeList.filter((item) => item.status != \"success\").length >\r\n          0\r\n        ) {\r\n          submitWarning(\"微信二维码未上传成功，请重试\");\r\n          return;\r\n        }\r\n        state.submitData.wxqrcode = state.wxqrcodeList[0].url;\r\n      }\r\n      if (state.imgsList.length > 0) {\r\n        if (\r\n          state.imgsList.filter((item) => item.status != \"success\").length > 0\r\n        ) {\r\n          submitWarning(\"图片未上传成功，请重试\");\r\n          return;\r\n        }\r\n        state.submitData.imgs = state.imgsList\r\n          .map((item) => item.url)\r\n          .join(\",\");\r\n      }\r\n      if (state.idnumImgsList.length > 0) {\r\n        if (\r\n          state.idnumImgsList.filter((item) => item.status != \"success\")\r\n            .length > 0\r\n        ) {\r\n          submitWarning(\"身份证图片未上传成功，请重试\");\r\n          return;\r\n        }\r\n        state.submitData.idnumImgs = state.idnumImgsList\r\n          .map((item) => item.privateUrl)\r\n          .join(\",\");\r\n      }\r\n      if (state.avatarList.length > 0) {\r\n        if (\r\n          state.avatarList.filter((item) => item.status != \"success\").length > 0\r\n        ) {\r\n          submitWarning(\"头像未上传成功，请重试\");\r\n          return;\r\n        }\r\n        state.submitData.avatar = state.avatarList\r\n          .map((item) => item.url)\r\n          .join(\",\");\r\n      }\r\n      // 验证手机号码格式\r\n      if (state.submitData.mobile) {\r\n        if (!/^\\d{11}$/.test(state.submitData.mobile)) {\r\n          submitWarning(\"请输入正确的手机号码\");\r\n          return;\r\n        }\r\n      }\r\n      // 校验\r\n      console.log(\"提交数据：\", state.submitData);\r\n      Taro.showLoading({\r\n        title: \"提交中\",\r\n        mask: true,\r\n      });\r\n      const res = API.requestAfterHandle(await API.cert(state.submitData));\r\n      if (res.msg != \"ok\") {\r\n        // Taro.showToast({\r\n        //   title: res.msg,\r\n        //   icon: \"error\",\r\n        //   duration: 2000,\r\n        //   mask: true,\r\n        // });\r\n        return false;\r\n      } else {\r\n        Taro.hideLoading();\r\n        Taro.showToast({\r\n          title: \"提交成功\",\r\n          icon: \"success\",\r\n          duration: 2000,\r\n          mask: true,\r\n        });\r\n        setTimeout(() => {\r\n          Taro.switchTab({\r\n            url: \"/pages/index/index\",\r\n          });\r\n        }, 2000);\r\n      }\r\n    };\r\n\r\n    const wxqrcodeSuccess = (e) => {\r\n      state.wxqrcodeList[state.wxqrcodeList.length - 1].url = JSON.parse(\r\n        e.responseText.data\r\n      ).data;\r\n    };\r\n    const imgsSuccess = (e) => {\r\n      state.imgsList[state.imgsList.length - 1].url = JSON.parse(\r\n        e.responseText.data\r\n      ).data;\r\n    };\r\n    const idnumImgsSuccess = (e) => {\r\n      state.idnumImgsList[state.idnumImgsList.length - 1].privateUrl =\r\n        JSON.parse(e.responseText.data).data;\r\n    };\r\n    const avatarSuccess = (e) => {\r\n      state.avatarList[state.avatarList.length - 1].url = JSON.parse(\r\n        e.responseText.data\r\n      ).data;\r\n    };\r\n\r\n    const getProfile = () => {\r\n      if (state.user?.authProfile) {\r\n        return true;\r\n      }\r\n      if (state.getUserProfileLoading) {\r\n        return false;\r\n      }\r\n      state.getUserProfileLoading = true;\r\n      const pLogin = new Promise((resolve, reject) => {\r\n        Taro.login({\r\n          success: function (res) {\r\n            resolve(res.code);\r\n          },\r\n        });\r\n      });\r\n      const pUserProfile = new Promise((resolve, reject) => {\r\n        Taro.getUserProfile({\r\n          // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写\r\n          desc: \"用于完善用户资料\",\r\n          success: (profile) => {\r\n            resolve(profile);\r\n          },\r\n        });\r\n      });\r\n      Promise.all([pLogin, pUserProfile]).then((values) => {\r\n        API.authLogin(values[0], values[1].encryptedData, values[1].iv).then(\r\n          (authLoginRes) => {\r\n            API.requestAfterHandle(authLoginRes, (data) => {\r\n              Taro.setStorageSync(\"user\", data);\r\n              state.user = data;\r\n            });\r\n            state.getUserProfileLoading = false;\r\n          }\r\n        );\r\n      });\r\n      return false;\r\n    };\r\n\r\n    const submitWarning = (txt) => {\r\n      Taro.showToast({\r\n        title: txt,\r\n        icon: \"error\",\r\n        duration: 1500,\r\n      });\r\n    };\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      submit,\r\n      servTypeConfirm,\r\n      servLocationConfirm,\r\n      hometownConfirm,\r\n      wxqrcodeSuccess,\r\n      imgsSuccess,\r\n      idnumImgsSuccess,\r\n      avatarSuccess,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.aycert {\r\n  margin: 0 30rpx 30rpx 30rpx;\r\n\r\n  .row {\r\n    margin-top: 30rpx;\r\n    background: #fff;\r\n    border-radius: 20rpx;\r\n    padding: 20rpx;\r\n\r\n    .title {\r\n      font-size: 28rpx;\r\n      line-height: 1.2rem;\r\n      display: flex;\r\n\r\n      .require {\r\n        color: red;\r\n        padding-left: 6rpx;\r\n      }\r\n    }\r\n\r\n    .desc {\r\n      font-size: 20rpx;\r\n      line-height: 0.8rem;\r\n      margin-top: 10rpx;\r\n    }\r\n\r\n    .err {\r\n      font-size: 20rpx;\r\n      line-height: 0.8rem;\r\n      margin-top: 10rpx;\r\n      color: red;\r\n    }\r\n\r\n    .content {\r\n      padding-top: 20rpx;\r\n\r\n      .nut-textarea,\r\n      .nut-input {\r\n        padding: 0;\r\n      }\r\n\r\n      .sub-row {\r\n        padding: 20rpx;\r\n        .sub-title {\r\n          font-size: 24rpx;\r\n        }\r\n        .sub-content {\r\n          padding-top: 10rpx;\r\n        }\r\n      }\r\n    }\r\n\r\n    &.btn {\r\n      background: rgba($color: #000000, $alpha: 0);\r\n      padding: 0 0 20rpx 0;\r\n\r\n      .submit {\r\n        font-size: 28rpx;\r\n        // background: #1d6308;\r\n        border-radius: 20rpx;\r\n        text-align: center;\r\n        height: 70rpx;\r\n        line-height: 70rpx;\r\n        // color: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"阿姨注册认证\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/aycert/index', {root:{cn:[]}}, config || {}))\n\n\n","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&lang=ts\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-26.use[0]!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=template&id=8a0fcb3a&ts=true\""],"names":[],"sourceRoot":""}